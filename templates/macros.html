{% macro page(page) -%}
  <a href="{{ page.permalink | safe }}" class="catalogue-link">
    <article class="catalogue-card">
      <div class="catalogue-text">
        <div class="catalogue-meta">
          <time datetime="{{ page.date }}">
            {{ page.date | date(format="%b %d, %Y") }}<span class="meta-sep"> · </span>{{ page.reading_time }} min
          </time>
        </div>
        <h3 class="catalogue-title">{{ page.title }}</h3>
        {% if page.extra.subtitle %}
        <p class="catalogue-subtitle">{{ page.extra.subtitle }}</p>
        {% endif %}
        {% if page.taxonomies.tags %}
        <div class="catalogue-tags">
          {% for tag in page.taxonomies.tags | slice(end=3) %}
            <span class="tag-pill">{{ tag | upper }}</span>
          {% endfor %}
        </div>
        {% endif %}
        <span class="catalogue-cta">Read more →</span>
      </div>
    </article>
  </a>
{%- endmacro %}

{% macro seo(
  title="",
  og_title="",
  description="",
  site_url="",
  image="",
  image_height="",
  image_width="",
  web_type="WebSite"
  ) -%}
{% if title %}
<title>{{ title }}</title>
{% endif %}

{% if og_title %}
<meta property="og:title" content="{{ og_title }}">
{% endif %}

<meta property="og:locale" content="{{ config.extra.seo.og_locale | default(value='en-US') }}">

{% if description %}
<meta name="description" content="{{ description }}">
<meta property="og:description" content="{{ description }}">
{% endif %}

{% if site_url %}
<link rel="canonical" href="{{ site_url | safe }}">
<meta property="og:url" content="{{ site_url | safe }}">
{% endif %}

{% if config.title %}
  <meta property="og:site_name" content="{{ config.title }}">
{% endif %}

{% if image %}
  <meta property="og:image" content="{{ get_url(path=image) | safe }}">
  {% if image_height -%}
    <meta property="og:image:height" content="{{ image_height }}">
  {%- endif %}
  {% if image_width -%}
    <meta property="og:image:width" content="{{ image_width }}">
  {%- endif %}
{% endif %}

{% if page.date %}
  <meta property="og:type" content="article">
  <meta property="article:published_time" content="{{ page.date | date(format='%+') }}">
{% endif %}

<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
<meta name="googlebot" content="index, follow">
<meta http-equiv="content-language" content="en-US">{% if page.taxonomies.tags %}
<meta name="keywords" content="{% for tag in page.taxonomies.tags %}{{ tag }}{% if not loop.last %}, {% endif %}{% endfor %}">{% endif %}

<meta name="twitter:card" content="summary_large_image">
{% if config.extra.seo.twitter.site %}
<meta name="twitter:site" content="@{{ config.extra.seo.twitter.site }}">
{% endif %}
{% if config.extra.seo.twitter.creator %}
<meta name="twitter:creator" content="@{{ config.extra.seo.twitter.creator }}">
{% endif %}
{% if og_title %}
<meta name="twitter:title" content="{{ og_title }}">
{% endif %}
{% if description %}
<meta name="twitter:description" content="{{ description }}">
{% endif %}
{% if image %}
<meta name="twitter:image" content="{% if page.extra.static_thumbnail %}{{ config.base_url | safe }}{{ page.extra.static_thumbnail | safe }}{% else %}{{ config.base_url | safe }}/assets/images/profile/jesus-150.webp{% endif %}">
<meta name="twitter:image:alt" content="{{ og_title | default(value='Blog post illustration') }}">
{% endif %}

{% if config.extra.seo.webmaster %}
  {% if config.extra.seo.webmaster.google %}
    <meta name="google-site-verification" content="{{ config.extra.seo.webmaster.google }}"/>
  {% endif %}

  {% if config.extra.seo.webmaster.bing %}
    <meta name="msvalidate.01" content="{{ config.extra.seo.webmaster.bing }}"/>
  {% endif %}
{% endif %}

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "{{ web_type }}",
  "headline": "{{ og_title }}",
  "description": "{{ description }}",
  "url": "{{ site_url | safe }}"{% if page.date %},
  "datePublished": "{{ page.date | date(format='%+') }}"{% endif %},
  "author": {
    "@type": "Person",
    "name": "Jesus Valera Reales",
    "url": "{{ config.base_url | safe }}"
  },
  "publisher": {
    "@type": "Person",
    "name": "Jesus Valera Reales",
    "url": "{{ config.base_url | safe }}",
    "logo": {
      "@type": "ImageObject",
      "url": "{{ config.base_url | safe }}/assets/images/profile/jesus-150.webp"
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "{% if page.extra.static_thumbnail %}{{ config.base_url | safe }}{{ page.extra.static_thumbnail | safe }}{% else %}{{ config.base_url | safe }}/assets/images/profile/jesus-150.webp{% endif %}"
  }{% if page.reading_time %},
  "timeRequired": "PT{{ page.reading_time }}M"{% endif %},
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "{{ site_url | safe }}"
  },
  "inLanguage": "en-US"
}
</script>
{%- endmacro %}
